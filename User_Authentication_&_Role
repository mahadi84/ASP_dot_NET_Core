рждрзБржорж┐ ржЫржмрж┐ржЯрж╛ ржкрзБрж░рзЛ ржЦрзБрж▓рзЗ ржлрзЗрж▓рзЗржЫтАФ**ASP.NET Core MVC 8/9 + MySQL + Identity + Login/Registration + Role-based Authorization**ред
ржЪрж▓рзЛ ржПржмрж╛рж░ ржкрзБрж░рзЛ рж╕рж┐рж╕рзНржЯрзЗржоржЯрж╛ржХрзЗ ржЧрзЗржБржерзЗ ржлрзЗрж▓рж┐ред ржмрзНржпрж╛ржЦрзНржпрж╛ржЯрж╛ рж╕рж╣ржЬ, ржкрж░рж┐рж╖рзНржХрж╛рж░ ржЖрж░ ржЖржзрзБржирж┐ржХ .NET рж╕рзНржЯрж╛ржЗрж▓рзЗ рж▓рж┐ржЦржЫрж┐ред

---

# ЁЯОп ржЪрзВржбрж╝рж╛ржирзНржд рж▓ржХрзНрж╖рзНржп

рждрзЛржорж╛рж░ MVC ржкрзНрж░ржЬрзЗржХрзНржЯрзЗ ржЪрж╛ржЗ:

**Login + Register + Forgot Password + Roles + Role-based Authorization + MySQL Database**

ржПржмржВ рж╕ржмржХрж┐ржЫрзБ ржХрж╛ржЬ ржХрж░ржмрзЗ ASP.NET Core 8/9 ржорж┐ржирж┐ржорж╛рж▓ рж╣рзЛрж╕рзНржЯрж┐ржВ ржоржбрзЗрж▓рзЗред

---

# ЁЯПЧя╕П ржзрж╛ржк рзз: ржирждрзБржи MVC ржкрзНрж░ржЬрзЗржХрзНржЯ рждрзИрж░рж┐

Terminal / CMD / VS Package Manager:

```
dotnet new mvc -n MyAuthProject
cd MyAuthProject
```

---

# ЁЯзй ржзрж╛ржк рзи: ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржкрзНржпрж╛ржХрзЗржЬ ржЗржирж╕рзНржЯрж▓

### тЬФ MySQL EF Core Provider

ржЕржлрж┐рж╢рж┐рзЯрж╛рж▓рж┐ Pomelo рж╕ржмржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛ:

```
dotnet add package Pomelo.EntityFrameworkCore.MySql
```

### тЬФ Identity support

(рж╕рж╛ржзрж╛рж░ржгржд MVC template-ржП ржерж╛ржХрзЗ, рждржмрзБ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛рж░ ржЬржирзНржп):

```
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
```

---

# ЁЯзм ржзрж╛ржк рзй: ApplicationDbContext рждрзИрж░рж┐ ржХрж░рж╛

**Data/ApplicationDbContext.cs**

```csharp
using Microsoft.AspNetCore.Identity.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore;

namespace MyAuthProject.Data
{
    public class ApplicationDbContext : IdentityDbContext
    {
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {
        }
    }
}
```

---

# тЪЩя╕П ржзрж╛ржк рзк: appsettings.json тЖТ MySQL Connection String

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Database=MyAuthDB;User=root;Password=1234;"
  }
}
```

рждрзЛржорж╛рж░ MySQL ржЕржирзБржпрж╛рзЯрзА ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб/ржирж╛ржо ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЛред

---

# ЁЯЪА ржзрж╛ржк рзл: Program.cs ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи (Core 8/9 ржоржбрзЗрж▓)

```csharp
using Microsoft.AspNetCore.Identity;
using Microsoft.EntityFrameworkCore;
using MyAuthProject.Data;

var builder = WebApplication.CreateBuilder(args);

// MySQL
var connectionString = builder.Configuration.GetConnectionString("DefaultConnection");

builder.Services.AddDbContext<ApplicationDbContext>(options =>
    options.UseMySql(connectionString, ServerVersion.AutoDetect(connectionString)));

// Identity
builder.Services.AddIdentity<IdentityUser, IdentityRole>()
    .AddEntityFrameworkStores<ApplicationDbContext>()
    .AddDefaultTokenProviders();

builder.Services.ConfigureApplicationCookie(options =>
{
    options.LoginPath = "/Identity/Account/Login";
    options.AccessDeniedPath = "/Identity/Account/AccessDenied";
});


app.MapRazorPages(); // ржЕржмрж╢рзНржпржЗ ржЖржЫрзЗ after, if (!app.Environment.IsDevelopment()))
app.UseAuthentication(); // ржЕржмрж╢рзНржпржЗ ржЖржЫрзЗ
app.UseAuthorization(); // ржЕржмрж╢рзНржпржЗ ржЖржЫрзЗ before, app.MapControllerRoute()


---

# ЁЯз▒ ржзрж╛ржк рзм: Identity UI Scaffold ржХрж░рж╛ (UI ржкрж╛ржУржпрж╝рж╛рж░ ржЬржирзНржп)

Visual Studio тЖТ
**Right Click Project тЖТ Add тЖТ New Scaffolded Item тЖТ Identity**

From the menu:

* Register
* Login
* Logout
* Account pages
* Manage pages (optional)

**Data Context** рж╣рж┐рж╕рзЗржмрзЗ `ApplicationDbContext` ржжрж┐ржиред

ржкрзЗржЬржЧрзБрж▓рзЛ рждрзИрж░рж┐ рж╣ржмрзЗ ржПржЦрж╛ржирзЗ:

```
Areas/Identity/Pages/Account/
```

---

# ЁЯЧДя╕П ржзрж╛ржк рзн: ржбрж╛ржЯрж╛ржмрзЗржЬ рждрзИрж░рж┐ + Migration

```
dotnet ef migrations add Initial
dotnet ef database update
```

ржпржжрж┐ Design-time error ржЖрж╕рзЗ тЖТ ржЖржорж┐ ржлрж┐ржХрзНрж╕ ржХрж░рзЗ ржжрзЗржмред

---

# ЁЯСС ржзрж╛ржк рзо: Roles рждрзИрж░рж┐ ржХрж░рж╛ (Admin, User ржЗрждрзНржпрж╛ржжрж┐)

ржПржХржмрж╛рж░рзЗрж░ ржЬржирзНржп Program.csтАУржП temporary role seeder ржжрж┐рждрзЗ ржкрж╛рж░рзЛ:

```csharp
using Microsoft.AspNetCore.Identity;
using Microsoft.Extensions.DependencyInjection;

async Task CreateRoles(IServiceProvider serviceProvider)
{
    var roleManager = serviceProvider.GetRequiredService<RoleManager<IdentityRole>>();

    string[] roles = { "Admin", "User" };

    foreach (var role in roles)
    {
        if (!await roleManager.RoleExistsAsync(role))
            await roleManager.CreateAsync(new IdentityRole(role));
    }
}

var scope = app.Services.CreateScope();
await CreateRoles(scope.ServiceProvider);
```

ржПржХржмрж╛рж░ рж░рж╛ржи ржХрж░рж▓рзЗржЗ рж░рзЛрж▓ рждрзИрж░рж┐ рж╣рзЯрзЗ ржпрж╛ржмрзЗред

---

# ЁЯФР ржзрж╛ржк рзп: рж░рзЛрж▓ ржЕрзНржпрж╛рж╕рж╛ржЗржи (Controller ржерзЗржХрзЗ)

```csharp
var user = await _userManager.FindByEmailAsync("test@gmail.com");
await _userManager.AddToRoleAsync(user, "Admin");
```

---

# ЁЯЪл ржзрж╛ржк рззрзж: Role-based Protect ржХрж░рж╛

### Controller-level:

```csharp
[Authorize(Roles = "Admin")]
public class DashboardController : Controller
{
}
```

### Action-level:

```csharp
[Authorize(Roles = "User")]
public IActionResult Profile() => View();
```

---

# ЁЯОп рж╕ржмржХрж┐ржЫрзБ рж╢рзЗрж╖рзЗ рждрзБржорж┐ ржкрзЗрзЯрзЗ ржпрж╛ржмрзЗ:

### тЬФ Login

`/Identity/Account/Login`

### тЬФ Register

`/Identity/Account/Register`

### тЬФ Logout

`/Identity/Account/Logout`

### тЬФ Role-based Admin panel

`[Authorize(Roles = "Admin")]`

рж╕ржмржХрж┐ржЫрзБ MySQL database-ржП рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣ржмрзЗред

---

# ЁЯФе ржпржжрж┐ рждрзБржорж┐ ржЪрж╛ржУ, ржЖржорж┐ рждрзЛржорж╛рж░ ржкрзБрж░рзЛ ржкрзНрж░ржЬрзЗржХрзНржЯ ржлрзЛрж▓рзНржбрж╛рж░рзЗрж░ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ ржжрзЗржЦрзЗ

ржарж┐ржХ ржХрзЛржерж╛рзЯ Register/Login ржкрзЗржЬ ржорж┐рж╕рж┐ржВ рж╕рзЗржЯрж╛ рззрзж рж╕рзЗржХрзЗржирзНржбрзЗ ржзрж░рж┐рзЯрзЗ ржжрзЗржмред

ржЕржержмрж╛ ржЪрж╛ржЗрж▓рзЗ рждрзЛржорж╛рж░ ржкрзБрж░рзЛ ржкрзНрж░ржЬрзЗржХрзНржЯрзЗрж░ Program.cs + appsettings.json + DbContext ржжрзЗржЦрзЗ
ржбрж╛ржЗрж░рзЗржХрзНржЯ ржХрзЛржб ржлрж┐ржХрзНрж╕ ржХрж░рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ред
