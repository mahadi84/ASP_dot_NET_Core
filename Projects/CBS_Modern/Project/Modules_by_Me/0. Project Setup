




## üß± 0. Clean Architecture skeleton-

CBS
 ‚îî‚îÄ src
    ‚îú‚îÄ CBS.Domain
    ‚îÇ   ‚îî‚îÄ Entities
    ‚îÇ       ‚îî‚îÄ User.cs
    |       ‚îî‚îÄ Customer.cs
    ‚îÇ
    ‚îú‚îÄ CBS.Application
    ‚îÇ   ‚îú‚îÄ Interfaces
    ‚îÇ   ‚îÇ   ‚îî‚îÄ ICustomerService.cs
    ‚îÇ   ‚îî‚îÄ Services
    ‚îÇ       ‚îî‚îÄ CustomerService.cs
    ‚îÇ
    ‚îú‚îÄ CBS.Infrastructure
    ‚îÇ   ‚îú‚îÄ Persistence
    ‚îÇ   ‚îÇ   ‚îî‚îÄ AppDbContext.cs
    ‚îÇ   ‚îî‚îÄ Repositories
    ‚îÇ       ‚îî‚îÄ CustomerRepository.cs
    ‚îÇ
    ‚îî‚îÄ CBS.Web
        ‚îî‚îÄ Controllers
        |    ‚îî‚îÄ CustomerController.cs
        ‚îî‚îÄ Models
        |    ‚îî‚îÄ ViewModel.cs
        ‚îî‚îÄ Views
            ‚îî‚îÄ User
                ‚îî‚îÄ User.cshtml

---



## üèÅ 1. Solution + Projects ‡¶§‡ßà‡¶∞‡¶ø (dotnet CLI ‡¶¶‡¶ø‡ßü‡ßá)
üëâ Command Prompt ‡¶¨‡¶æ PowerShell ‚Äì ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶ï‡¶ü‡¶æ‡¶§‡ßá ‡¶è‡¶á‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶¨‡ßá‡•§

```powershell
cd D:\AsPdOtNeT\DotNet

mkdir CBS
cd CBS

mkdir src
cd src


## Creates  C# Class Library(create .csproj file) for A PROJECT(a room of a house), 
## serves as a reusable container for your core business logic and entities.

dotnet new classlib -n CBS.Domain
dotnet new classlib -n CBS.Application
dotnet new classlib -n CBS.Infrastructure
dotnet new mvc -n CBS.Web



## Solution file named CBS.sln,a master CONTAINER(Architecture of Whole house)
## to manage and build all individual projects (Domain, Infrastructure, API, etc.) as a single unit.

cd ..   # Go back to the main folder (CBS)
dotnet new sln -n CBS

## ‡¶è‡¶ñ‡¶® ‡¶∏‡¶¨ project-‡¶ï‡ßá solution-‡¶è add ‡¶ï‡¶∞‡¶ø:
dotnet sln CBS.sln add src\CBS.Domain\CBS.Domain.csproj
dotnet sln CBS.sln add src\CBS.Application\CBS.Application.csproj
dotnet sln CBS.sln add src\CBS.Infrastructure\CBS.Infrastructure.csproj
dotnet sln CBS.sln add src\CBS.Web\CBS.Web.csproj


---

## üîó 2. Dependency (‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞‡¶∂‡ßÄ‡¶≤‡¶§‡¶æ) ‡¶¨‡¶æ Layer (inner/Onion) Connection ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§
          
      Web->Infrastructure->Application->Domain
 
     # 2.‡ßß. Application ‡¶∂‡ßÅ‡¶ß‡ßÅ Domain-‡¶ï‡ßá ‡¶ö‡¶ø‡¶®‡¶¨‡ßá (Entities & Interfaces)
     dotnet add src\CBS.Application reference src\CBS.Domain
     
     # 2.‡ß®. Infrastructure, Domain-‡¶ï‡ßá ‡¶ö‡¶ø‡¶®‡¶¨‡ßá (Entities ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)  ‡¶è‡¶¨‡¶Ç  'Application' ‡¶ï‡ßá‡¶ì ‡¶ö‡¶ø‡¶®‡¶¨‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶´‡ßá‡¶∏ ‡¶á‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
     dotnet add src\CBS.Infrastructure reference src\CBS.Domain
     dotnet add src\CBS.Infrastructure reference src\CBS.Application
     
     # 2.‡ß©. Web API ‡¶∏‡¶¨ ‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡¶ï‡ßá ‡¶ö‡¶ø‡¶®‡¶¨‡ßá (Dependency Injection ‡¶¨‡¶æ ‡¶Ü‡¶†‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶ú‡ßã‡ßú‡¶æ ‡¶≤‡¶æ‡¶ó‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
     dotnet add src\CBS.Web reference src\CBS.Domain
     dotnet add src\CBS.Web reference src\CBS.Application
     dotnet add src\CBS.Web reference src\CBS.Infrastructure

          ## 2.4 Dependency-Reference  ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ: 
           cd src/CBS.Infrastructure  # ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ì‡¶á ‡¶™‡ßç‡¶∞‡ßã‡¶ú‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶∞ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞‡ßá ‡¶¢‡ßÅ‡¶ï‡ßÅ‡¶®
           dotnet list reference      # ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®


## üìÅ 3. NuGet Packages

dotnet add src\CBS.Infrastructure package Dapper              # For Dapper
dotnet add src\CBS.Infrastructure package MySqlConnector      # For MySQL Conection 

dotnet add src\CBS.Infrastructure package dbup-mysql          # To Create Migration File for MySQL database

dotnet add src\CBS.Infrastructure package BCrypt.Net-Next     # ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° Hash ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡•§ ‡¶Ø‡¶æ‡¶§‡ßá ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶π‡ßç‡¶Ø‡¶æ‡¶ï ‡¶π‡¶≤‡ßá‡¶ì ‡¶ï‡ßá‡¶â ‡¶Ü‡¶∏‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶æ ‡¶™‡¶æ‡ßü‡•§
dotnet add src\CBS.Infrastructure package QuestPDF            # ‡¶è‡¶á ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶•‡ßá‡¶ï‡ßá PDF ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¨‡¶æ ‡¶á‡¶®‡¶≠‡ßü‡ßá‡¶∏ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡•§

-- for using ef--
dotnet add src\CBS.Infrastructure package Pomelo.EntityFrameworkCore.MySql  --version 9.0.0      # MySQL ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ú‡¶®‡¶™‡ßç‡¶∞‡¶ø‡ßü ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶™‡ßç‡¶∞‡ßã‡¶≠‡¶æ‡¶á‡¶°‡¶æ‡¶∞‡•§
dotnet add src\CBS.Infrastructure package Microsoft.EntityFrameworkCore.Tools --version 9.0.0    # ‡¶Æ‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶° ‡¶ö‡¶æ‡¶≤‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§
dotnet add src\CBS.Infrastructure package Microsoft.EntityFrameworkCore.Design --version 9.0.0   # ‡¶è‡¶á ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú‡¶ü‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ Migrations ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶ø‡¶Ç (Scaffolding) ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßÄ‡ßü ‡¶ü‡ßÅ‡¶≤‡¶∏ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßá‡•§
dotnet add src\CBS.Web package Microsoft.EntityFrameworkCore.Design --version 9.0.0              # ‡¶Æ‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶´‡¶æ‡¶á‡¶≤‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡•§



### 4. appsettings.json:

{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Database=MyDb;User=root;Password=your_password;"
  }
}


### 5. Route Configuration (Program.cs) .NET 9- Dependency Injection:

// ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç‡¶ü‡¶ø ‡¶∞‡¶ø‡¶° ‡¶ï‡¶∞‡¶æ
var connectionString = builder.Configuration.GetConnectionString("DefaultConnection");
// MySqlDataSource for Dapper ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ .NET 8/9 ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶¨‡¶ö‡ßá‡ßü‡ßá ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶ü ‡¶â‡¶™‡¶æ‡ßü
builder.Services.AddMySqlDataSource(connectionString);

// DbUp ‡¶Æ‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶® ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ
var upgrader = DeployChanges.To
    .MySqlDatabase(connectionString)
    .WithScriptsEmbeddedInAssembly(Assembly.GetExecutingAssembly())
    .LogToConsole()
    .Build();

// ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ö‡ßá‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶æ‡¶®
if (upgrader.IsUpgradeRequired())
{
    var result = upgrader.PerformUpgrade();

    if (!result.Successful)
    {
        Console.WriteLine("‡¶Æ‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡ßü‡ßá‡¶õ‡ßá: " + result.Error);
    }
    else
    {
        Console.WriteLine("‡¶Æ‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
    }
}




### 6. Use of Dapper

using Dapper;           // Dapper ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶á‡¶Æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá
using MySqlConnector;   // MySqlDataSource ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

public class BranchService
{
    private readonly MySqlDataSource _dataSource; // DataSource ‡¶á‡¶®‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
    // ‡¶ï‡¶®‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡ßç‡¶ü‡¶∞‡ßá MySqlDataSource ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
    public BranchService(MySqlDataSource dataSource)
    {
      _dataSource = dataSource;
    }

    public async Task<Result<int>> CreateBranchAsyn(BranchCreateDTO bdto, int UserID)
    {
        // ‡ßß. Dapper ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá Branch Code ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
        const string sql = "SELECT COUNT(1) FROM Branches WHERE BranchCode = @BranchCode";        
        //Open database connection as we use "using var" no need to close it
        using var connection = await _dataSource.OpenConnectionAsync();
       // ExecuteScalarAsync ‡¶¶‡¶ø‡ßü‡ßá ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶Ü‡¶®‡¶æ ‡¶Ø‡¶æ‡ßü
        // new { BranchCode = bdto.BranchCode }: ‡¶è‡¶ñ‡¶æ‡¶®‡ßá Dapper ‡¶ï‡ßá ‡¶¨‡¶≤‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶Ø‡ßá SQL ‡¶è‡¶∞ @BranchCode ‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ DTO ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶∏‡¶æ ‡¶Ü‡¶∏‡¶≤ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ‡¶ü‡¶æ ‡¶¨‡¶∏‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶§‡ßá‡•§ ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø Anonymous Object‡•§
        var count = await connection.ExecuteScalarAsync<int>(sql, new { BranchCode = bdto.BranchCode });
}







.
