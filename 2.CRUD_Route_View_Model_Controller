
## Menu:   

01. <a asp-route="Product1">Home</a> 
Note: Using asp-route="AllProducts" is the best practice.

02.<a
asp-area=""
asp-controller="Product1"    //Directs the request to the Product1Controller.
asp-action="ShowAll"         //Directs the request to the ShowAll() method within the ProductController.
>Home</a>

###################### CRUD ###################

CREAT:
context.Students.Add(newStudent);
await context.SaveChangesAsync(); // ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£

READ:
var allStudents = await context.Students.ToListAsync(); 
var student = await context.Students.FirstOrDefaultAsync(s => s.Id == 1);

UPDATE:
var studentToUpdate = await context.Students.FindAsync(1);
if (studentToUpdate != null)
{
    studentToUpdate.Name = "New Name";
    await context.SaveChangesAsync(); // ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
}

DELETE:
var studentToDelete = await context.Students.FindAsync(1);
if (studentToDelete != null)
{
    context.Students.Remove(studentToDelete);
    await context.SaveChangesAsync(); // ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ
}

## üéØ ‡¶ï‡¶ñ‡¶® ‡¶ï‡ßã‡¶®‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?

### `Find()` ‡¶ï‡¶ñ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?
‡¶Ø‡¶ñ‡¶® ‡¶Ü‡¶™‡¶®‡¶ø Entity Framework Core ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡ßá‡¶® ‡¶è‡¶¨‡¶Ç:
1.  ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ï‡ßÄ (Primary Key) ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶®‡ßç‡¶ü‡¶ø‡¶ü‡¶ø ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶õ‡ßá‡¶®‡•§
2.  ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ö‡¶æ‡¶® ‡¶Ø‡ßá Context Cache-‡¶è ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶π‡ßã‡¶ï, ‡¶Ø‡¶æ‡¶§‡ßá ‡¶è‡¶ï‡¶á ‡¶è‡¶®‡ßç‡¶ü‡¶ø‡¶ü‡¶ø ‡¶¨‡¶æ‡¶∞‡¶¨‡¶æ‡¶∞ ‡¶™‡ßú‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶π‡¶ø‡¶ü ‡¶®‡¶æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡ßü‡•§ ‡¶è‡¶ü‡¶ø ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶â‡¶®‡ßç‡¶®‡¶§ ‡¶ï‡¶∞‡ßá, ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑‡¶§ ‡¶Ø‡¶ñ‡¶® ‡¶è‡¶ï‡¶á `DbContext` ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡¶æ‡¶∞‡¶¨‡¶æ‡¶∞ ‡¶è‡¶ï‡¶á ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶π‡ßü‡•§

### `FirstOrDefault()` ‡¶ï‡¶ñ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?
‡¶Ø‡¶ñ‡¶® ‡¶Ü‡¶™‡¶®‡¶ø LINQ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡ßá‡¶® ‡¶è‡¶¨‡¶Ç:
1.  ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ï‡ßÄ ‡¶õ‡¶æ‡ßú‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶∂‡¶∞‡ßç‡¶§ (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶®‡¶æ‡¶Æ, ‡¶á‡¶Æ‡ßá‡¶≤, ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø) ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶æ ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶õ‡ßá‡¶®‡•§
2.  ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶æ‡¶≤‡ßá‡¶ï‡¶∂‡¶®‡¶ü‡¶ø ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶®‡¶ü‡¶ø ‡¶®‡¶ø‡¶§‡ßá ‡¶ö‡¶æ‡¶®, ‡¶∂‡¶∞‡ßç‡¶§‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶®‡¶æ ‡¶π‡¶≤‡ßá‡¶ì ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ï‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶æ‡•§
3.  ‡¶Ü‡¶™‡¶®‡¶ø `Include()` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶∞‡¶ø‡¶≤‡ßá‡¶ü‡ßá‡¶° ‡¶°‡ßá‡¶ü‡¶æ (Related Data) ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®‡•§
4.  ‡¶Ü‡¶™‡¶®‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§‡¶≠‡¶æ‡¶¨‡ßá ‡¶ö‡¶æ‡¶® ‡¶Ø‡ßá ‡¶ï‡ßã‡ßü‡ßá‡¶∞‡¶ø‡¶ü‡¶ø ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶è‡¶ï‡ßç‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶ü (Execute) ‡¶π‡ßã‡¶ï (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶®‡¶§‡ßÅ‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)‡•§

### ‚ö†Ô∏è ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡ßã‡¶ü (Important Note)
 `FirstOrDefault()` ‡¶¶‡¶ø‡ßü‡ßá ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶ï‡ßÄ ‡¶¶‡¶ø‡ßü‡ßá‡¶ì ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶Ø‡¶æ‡ßü, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ EF Core-‡¶è `Find()` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶á ‡¶∂‡ßç‡¶∞‡ßá‡¶Ø‡¶º, ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶è‡¶ü‡¶ø ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂‡ßá ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§‡¶§‡¶∞ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
 ‡¶Ø‡¶¶‡¶ø `FirstOrDefault()` ‡¶è‡¶∞ ‡¶∂‡¶∞‡ßç‡¶§ ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶π‡ßü, ‡¶§‡¶¨‡ßá ‡¶è‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ø‡ßá ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶®‡¶ü‡¶ø ‡¶™‡¶æ‡¶¨‡ßá, ‡¶∏‡ßá‡¶ü‡¶ø‡¶á ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡¶¨‡ßá‡•§





############## Route(Program.cs) ##############
app.MapControllerRoute(name:"Test",  pattern: "{controller=Test}/{action=ShowAll}" );



############ View ##############
@{
    ViewData["Title"] = "Home Page";
}
        @model string
        @Model 

            <h1>@ViewBag.message</h1>
                <h1>@ViewBag[message]</h1>

 @* The form points to the POST version of the Create action *@
 <form asp-action="CreateUser" asp-controller="Home" method="post">
     
     @Html.AntiForgeryToken()  @* Important for security against Cross-Site Request Forgery (CSRF) *@

     <div class="form-group">
         <label asp-for="name" class="control-label"></label>
         <input asp-for="name" class="form-control" />
         <span asp-validation-for="name" class="text-danger"></span>
     </div>    

     <div class="form-group mt-4">
         <input type="submit" value="Create" class="btn btn-success" />
         <a asp-action="User" class="btn btn-secondary ml-2">Back to List</a>
     </div>
 </form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}



############ Model ##############
namespace test.Models
{
    public class LoginModel
    {
        [Required(ErrorMessage = "Username is required.")]
        public string Username { get; set; }

        [Required(ErrorMessage = "Password is required.")]
        [StringLength(100, MinimumLength = 6, ErrorMessage = "Password must be at least 6 characters long.")]
        public string Password { get; set; }

    }
}

############ Controller ##############

[Authorize]            //‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶ü (‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶ü)
[Route]                //‡¶∂‡ßÅ‡¶ß‡ßÅ URL ‡¶™‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡ßç‡¶®‡•§ (‡¶Æ‡ßá‡¶•‡¶° ‡¶®‡¶ø‡¶∞‡¶™‡ßá‡¶ï‡ßç‡¶∑)
[Route("api/stock")]
[Route("{id:int}")]

[ApiController]

[HttpGet("{id:int}")]
[HttpGet]             //URL ‡¶™‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡ßç‡¶® + HTTP GET ‡¶Æ‡ßá‡¶•‡¶°‡•§ (‡¶Æ‡ßá‡¶•‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü)
[HttpPost]
[HttpPut]
[HttpDelete]

public async Task<IActionResult> GetAll([FromQuery] QueryObject query){}   //‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶ü ([FromQuery]): ‡¶Ö‡¶∞‡ßç‡¶•: "‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∞‡¶ø ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç (Query String) ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶æ‡¶ì‡•§" ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ URL: /api/stock?symbol=AAPL&limit=10
public async Task<IActionResult> Create([FromBody] CreateStockRequestDto stockDto){} //‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶ü ([FromBody]):  ‡¶Ö‡¶∞‡ßç‡¶•: "HTTP ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶¨‡¶°‡¶ø (Body) ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶æ‡¶ì‡•§" ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: JSON/XML ‡¶¨‡¶°‡¶ø‡¶§‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º, ‡¶Ø‡¶æ ‡¶´‡¶∞‡ßç‡¶Æ‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º C# ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡ßá‡•§ 
public async Task<IActionResult> GetById([FromRoute] int id){}            //‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶ü ([FromRoute]):   ‡¶Ö‡¶∞‡ßç‡¶•: "‡¶∞‡ßÅ‡¶ü ‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ (Route Parameter) ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶æ‡¶ì‡•§" ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ URL: /api/stock/5
public async Task<IActionResult> Update([FromRoute] int id, [FromBody] UpdateStockRequestDto updateDto){}
public async Task<IActionResult> Delete([FromRoute] int id){}


----------

using CRUD.Data;
using CRUD.Models;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using System.Diagnostics;

namespace CRUD.Controllers;

public class HomeController : Controller
{
    private readonly ApplicationDbContext _context;

    public HomeController(ApplicationDbContext context){ // Dependency Injection
        _context = context;
    }


public IActionResult Index(){
    return View();
}

    public IActionResult Employees(){
        var emp = _context.employees.ToList();
        return View(emp);   //return Json(c);
    }



//------------------------ Show All User  -----------------------------------
    public IActionResult User(){
        var u = _context.user.ToList();
        return View(u);   //return Json(c);
    }


//----------------------------------- ADD User  -----------------------------------

    [HttpGet] // Optional, but good practice to specify it only handles GET requests
    public IActionResult CreateUserForm()
    {        
        return View(); // Searches for Views/Home/Create.cshtml
    }



    // POST: /Home/Create - Handles the form submission
    [HttpPost]
    [ValidateAntiForgeryToken]
    public async Task<IActionResult> CreateUser(User user)
    {
        if (ModelState.IsValid)
        {
            try
            {
                _context.user.Add(user);
                await _context.SaveChangesAsync();

                TempData["SuccessMessage"] = "User created successfull!";  // ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá
                return RedirectToAction("CreateUserForm");
            }
            catch (Microsoft.EntityFrameworkCore.DbUpdateException ex)  // DbUpdateException ‡¶ß‡¶∞‡ßá (Catch) ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
            {
                var innerException = ex.InnerException; // Inner Exception ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ

                // MySQL ‡¶™‡ßç‡¶∞‡ßã‡¶≠‡¶æ‡¶á‡¶°‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá Inner Exception‡¶ü‡¶ø MySqlException ‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶§‡ßÅ‡¶≤‡ßç‡¶Ø ‡¶π‡¶¨‡ßá‡•§
                // MySqlConnector ‡¶¨‡¶æ MySQL.Data ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶è‡¶∞‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü‡•§
                // MySql-‡¶è‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞‡ßç‡¶° ‡¶°‡ßÅ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶ü ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶è‡¶∞‡¶∞ ‡¶ï‡ßã‡¶° (Error Code 1062)
                if (innerException != null && innerException.Message.Contains("Duplicate entry") && innerException.Message.Contains("for key"))
                {
                    TempData["ErrorMessage"] = "Role already exist";  // ‡¶°‡ßÅ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶ü ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ
                    ModelState.AddModelError(string.Empty, "Role already exist");  // ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶∏‡ßç‡¶ü‡ßá‡¶ü-‡¶è‡¶ì ‡¶è‡¶∞‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶≠‡¶æ‡¶≤‡ßã
                }
                else
                {
                    TempData["ErrorMessage"] = "Database error during creation."; // ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶è‡¶∞‡¶∞
                }
            }
            catch (Exception ex)
            {               
                Console.WriteLine($"Database error during creation: {ex.Message}");  // ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶∏‡¶¨ ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶è‡¶∞‡¶∞
                TempData["ErrorMessage"] = "User created failed!";
            }
        }
        return View("CreateUserForm", user); // ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶° ‡¶®‡¶æ ‡¶π‡¶≤‡ßá ‡¶¨‡¶æ ‡¶è‡¶∞‡¶∞ ‡¶π‡¶≤‡ßá, ‡¶≠‡¶ø‡¶â‡¶§‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ
    }





    //----------------------------------- EDIT User  -----------------------------------
    [HttpGet]
    public async Task<IActionResult> Edit(int? id)
    {
        if (id == null)
        {
            return NotFound(); // Return 404 if no ID is provided
        }

        // 1. Fetch the existing user from the database
        var userToEdit = await _context.user.FindAsync(id);

        if (userToEdit == null)
        {
            return NotFound(); // Return 404 if user ID is not found
        }

        // 2. Pass the fetched user object to the View
        return View(userToEdit);
    }




    // --- POST ACTION: Handle Form Submission and Save Changes ---
    [HttpPost]
    [ValidateAntiForgeryToken]
    public async Task<IActionResult> Edit(int id, User user)
    {
        // Check if the ID from the route matches the ID in the form data
        if (id != user.id)
        {
            return NotFound();
        }

        if (ModelState.IsValid)
        {
            try
            {
                // 1. Tell EF Core that the user object has been modified
                _context.Update(user);

                // 2. Execute the UPDATE SQL command in the database
                await _context.SaveChangesAsync();

                // Set Success message using TempData
                TempData["SuccessMessage"] = "User details updated successfully!"; // SUCCESS MESSAGE

                // 3. Redirect back to the list page
                return RedirectToAction("Edit", new { id = user.id });
            }
            catch (DbUpdateConcurrencyException)
            {
                // Handle concurrency error
                if (!_context.user.Any(e => e.id == user.id))
                {
                    return NotFound();
                }
                else
                {
                    throw;
                }
            }
            catch (Microsoft.EntityFrameworkCore.DbUpdateException ex)
            {
                // Handle MySQL Duplicate Entry Error (Error Code 1062 often shows up in the message for MySqlConnector)
                var innerException = ex.InnerException;

                if (innerException != null && innerException.Message.Contains("Duplicate entry") && innerException.Message.Contains("for key"))
                {
                    // Set Duplicate Entry Error Message
                    TempData["ErrorMessage"] = "The data entered already exists. Duplicate entry is not allowed."; // ERROR MESSAGE
                    ModelState.AddModelError(string.Empty, "The data entered is already in use. Please use a different value."); // MODEL ERROR
                }
                else
                {
                    // General Database Error Message
                    TempData["ErrorMessage"] = "An unexpected error occurred while saving data."; // ERROR MESSAGE
                    ModelState.AddModelError(string.Empty, "An unknown error occurred during the update process."); // MODEL ERROR
                }
            }
            
        }

        // If validation fails or an error occurs, return the form with the user's input
        return View("Edit", user);
    }



    //----------------------------------- DELETE User  -----------------------------------
    // The DeleteConfirmed method handles the POST request to delete a user record.
    [HttpPost]
    [ValidateAntiForgeryToken]
    public async Task<IActionResult> DeleteConfirmed(int id)
    {
        // Find the user to be deleted based on the ID.
        var user = await _context.user.FindAsync(id);

        // 1. EXISTENCE VALIDATION: Check if the user exists.
        if (user == null)
        {
            // If the user is not found (perhaps already deleted), return 404.
            return NotFound();
        }

        try
        {
            // 2. Remove the user object from the tracking list
            _context.user.Remove(user);

            // 3. Execute the DELETE SQL command
            await _context.SaveChangesAsync();

            // 4. Return success status (204 No Content is standard for successful AJAX deletion)
            return NoContent();
        }
        catch (Exception ex)
        {
            // Log the error (in a real app, use ILogger.LogError)
            Console.WriteLine($"Database error during deletion: {ex.Message}");

            // Return a 500 Internal Server Error status with the error message
            return StatusCode(500, "Error deleting the user: " + ex.Message);
        }
    }








[ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
public IActionResult Error(){
    return View(new ErrorViewModel { RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier });
}







}



.
