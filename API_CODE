
Weblink: https://github.com/teddysmithdev/

DTO ржХрзА? 
Data Transfer Object ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░ ржЖрж╕рж▓ ржХрж╛рж░ржгтАФ
ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржерж╛ржХрж╛ рж╕ржм ржлрж┐рж▓рзНржб ржЗржЙржЬрж╛рж░ржХрзЗ ржжрзЗржЦрж╛ржмрзЛ ржирж╛, 
ржЖржмрж╛рж░ ржЗржЙржЬрж╛рж░ржХрзЗржУ рж╕ржм ржлрж┐рж▓рзНржб ржкрж╛ржарж╛рждрзЗ ржжрзЗржмрзЛ ржирж╛ред

MAPPER ржХрзА?
to connect DTOs to controller.
MAPPER рж╣рж▓рзЛ ржПржХржЯрж┐ ржЯрзБрж▓ ржмрж╛ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ (ржпрзЗржоржи AutoMapper) 
ржпрж╛ ржПржХржЯрж┐ ржЕржмржЬрзЗржХрзНржЯрзЗрж░ ржбрзЗржЯрж╛ ржЕржирзНржп ржПржХржЯрж┐ ржЕржмржЬрзЗржХрзНржЯрзЗ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржХржкрж┐ ржмрж╛ ржорзНржпрж╛ржк ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣ржпрж╝,
ржпрж╛ .NET API-рждрзЗ рж╕рж╛ржзрж╛рж░ржгржд Model (ржмрж╛ Entity) ржПржмржВ DTO (Data Transfer Object)-ржПрж░ ржоржзрзНржпрзЗ ржбрзЗржЯрж╛ ржЖржжрж╛ржи-ржкрзНрж░ржжрж╛ржирзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред



ЁЯФ╣ Repository Pattern + Data Injection(DI) ржХрзА? (рж╕рж╣ржЬ ржХржерж╛)
ЁЯСЙ рж╕ржорж╕рзНржпрж╛ ржХрзА?
>Controller рж╕рж░рж╛рж╕рж░рж┐ Database ржЬрж╛ржирзЗ >Business logic, data access рж╕ржм ржПржХ ржЬрж╛рзЯржЧрж╛рзЯ
>ржХрж╛рж▓ database ржмржжрж▓рж╛рж▓рзЗ? >ржХрж╛рж▓ unit test рж▓рж┐ржЦрж▓рзЗ?

ржПржЦрж╛ржирзЗржЗ Repository Pattern + Dependency Injection (DI) ржЖрж╕рзЗред
Repository ржорж╛ржирзЗ Data-ржПрж░ ржЬржирзНржп ржПржХржЬржи ржжрж╛рж▓рж╛рж▓ (broker)ред
-Controller ржЖрж░ Database рж╕рж░рж╛рж╕рж░рж┐ ржХржерж╛ ржмрж▓ржмрзЗ ржирж╛ред
-Controller ржХржерж╛ ржмрж▓ржмрзЗ Repository-ржПрж░ рж╕рж╛ржерзЗ,
-Repository ржХржерж╛ ржмрж▓ржмрзЗ Database-ржПрж░ рж╕рж╛ржерзЗред
--Controller тЖТ Repository тЖТ Database

>>ржПрждрзЗ ржХрзА рж╣рзЯ?
-Controller ржкрж░рж┐рж╖рзНржХрж╛рж░ ржерж╛ржХрзЗ
-Data access ржПржХ ржЬрж╛рзЯржЧрж╛рзЯ ржерж╛ржХрзЗ
-Test ржХрж░рж╛ ржпрж╛рзЯ
-Database ржмржжрж▓рж╛ржирзЛ рж╕рж╣ржЬ рж╣рзЯ

ЁЯФР JWT ржХрзА? 
JWT (JSON Web Token) рж╣рж▓рзЛ
тАЬрж▓ржЧржЗржи ржХрж░рж╛рж░ ржкрж░ ржЗржЙржЬрж╛рж░рзЗрж░ ржкрж░рж┐ржЪрзЯ ржмрж╣ржи ржХрж░рж╛ ржПржХржЯрж╛ ржбрж┐ржЬрж┐ржЯрж╛рж▓ ржкрж╛рж╕тАЭред
-JWT ржПржоржи ржПржХржЯрж╛ ржЬрж┐ржирж┐рж╕, ржпрзЗржЯрж╛ ржмрзБржЭрзЗ ржлрзЗрж▓рж▓рзЗ API ржирж┐рж░рж╛ржкрждрзНрждрж╛рж░ ржЕрж░рзНржзрзЗржХ ржЦрзЗрж▓рж╛ржЗ рж╢рзЗрж╖ тЬЕ

ржПржЯрж╛ server ржмрж╛ржирж╛рзЯ, client ржмрж╣ржи ржХрж░рзЗ, ржЖрж░ ржкрзНрж░рждрж┐ржЯрж╛ request-ржП server ржжрзЗржЦрзЗржЗ ржмрзБржЭрзЗ ржирзЗрзЯтАФ
тАЬржПржЗ ржЗржЙржЬрж╛рж░ ржХрзЗ, рж╕рзЗ allowed ржХрж┐ржирж╛тАЭред


ЁЯОЯя╕П Token (ржЯрзЛржХрзЗржи): ржХрзНрж▓рж╛ржмрзЗрж░ ржкрзНрж░ржмрзЗрж╢ржкрждрзНрж░ (The Club Entry Pass)
ржЖржкржирж╛рж░ API-ржПрж░ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯрзЗ ржПржХржЯрж┐ Token рж╣рж▓рзЛ ржПржХржЯрж┐ ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржЪрж╛ржмрж┐ ржмрж╛ ржЕржирзБржорждрж┐ржкрждрзНрж░ред 
ржПржЯрж┐ ржПржХржЯрж┐ ржПржиржХрзНрж░рж┐ржкрзНржЯрзЗржб (Encrypted) рж╕рзНржЯрзНрж░рж┐ржВ, ржпрж╛ ржЖржкржирж╛рж░ ржкрж░рж┐ржЪрзЯ ржПржмржВ ржХрзА ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ ржЖржЫрзЗ, рж╕рзЗржЗ рждржерзНржп ржмрж╣ржи ржХрж░рзЗред 
ржПржЯрж┐ ржкрзНрж░ржорж╛ржг ржХрж░рзЗ ржпрзЗ ржЖржкржирж┐ ржПржХржЬржи ржЕржирзБржорзЛржжрж┐ржд ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА (Authorized User)ред

Scalar ржПржмржВ Swagger ржХрзА? 
Scalar: ржПржЯрж┐ рж╣рж▓рзЛ Swagger UI-ржПрж░ ржПржХржЯрж┐ ржЖржзрзБржирж┐ржХ ржПржмржВ ржжрзНрж░рзБржд ржмрж┐ржХрж▓рзНржк 
ржпрж╛ OpenAPI ржбржХрзБржорзЗржирзНржЯ (API-ржПрж░ ржмрзНрж▓рзБржкрзНрж░рж┐ржирзНржЯ) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХржЯрж┐ рж╕рзБржирзНржжрж░, ржЗржирзНржЯрж╛рж░рзЗржХрзНржЯрж┐ржн ржУ ржбрзЗржнрзЗрж▓ржкрж╛рж░-ржмрж╛ржирзНржзржм ржЗржЙржЬрж╛рж░ ржЗржирзНржЯрж╛рж░ржлрзЗрж╕ рждрзИрж░рж┐ ржХрж░рзЗ, ржпрж╛рж░ ржорж╛ржзрзНржпржорзЗ API-ржХрзЗ ржкрж░рзАржХрзНрж╖рж╛ ржПржмржВ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛ржпрж╝ред

Swagger: ржПржЯрж┐ рж╣рж▓рзЛ ржПржХржЯрж┐ ржЬржиржкрзНрж░рж┐ржпрж╝ ржлрзНрж░рзЗржоржУржпрж╝рж╛рж░рзНржХрзЗрж░ рж╕рзЗржЯ (ржпрзЗржоржи: Swagger-UI, Swagger-Codegen) 
ржпрж╛ OpenAPI Specification (ржПржХржЯрж┐ рж╢рж┐рж▓рзНржк ржорж╛ржиржжржгрзНржб) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж╛рж░ .NET API-ржПрж░ ржЬржирзНржп рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржЗржирзНржЯрж╛рж░рзЗржХрзНржЯрж┐ржн ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи рждрзИрж░рж┐ ржХрж░рзЗ, ржпрж╛рждрзЗ ржбрзЗржнрзЗрж▓ржкрж╛рж░рж░рж╛ рж╕рж╣ржЬрзЗ ржЖржкржирж╛рж░ API рж╕ржорзНржкрж░рзНржХрзЗ ржЬрж╛ржирждрзЗ ржУ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗред

##################### Controller: ##################### 

using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using RestAPI.Data;
using RestAPI.Models;

namespace RestAPI.Controllers
{

    [Route("api/[controller]")] // API рж░рзБржЯ: /api/Emps
    [ApiController] // ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рзЗ ржпрзЗ ржПржЯрж┐ ржПржХржЯрж┐ API ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░
    public class EmployeeController : ControllerBase
    {
        private readonly ApplicationDbContext _context; // ржбрзЗржЯрж╛ржмрзЗрж╕ ржХржиржЯрзЗржХрзНрж╕ржЯ ржЗржиржЬрзЗржХрж╢ржи

        // ржХржирж╕рзНржЯрзНрж░рж╛ржХрзНржЯрж░: ржбрж┐ржкрзЗржирзНржбрзЗржирзНрж╕рж┐ ржЗржиржЬрзЗржХрж╢ржирзЗрж░ ржорж╛ржзрзНржпржорзЗ ржбрзЗржЯрж╛ржмрзЗрж╕ ржХржиржЯрзЗржХрзНрж╕ржЯ ржЧрзНрж░рж╣ржг ржХрж░рж╛ рж╣ржпрж╝
        public EmployeeController(ApplicationDbContext context)
        {
            _context = context;
        }

        // 1. GET: /api/Emps (рж╕ржорж╕рзНржд ржбрзЗржЯрж╛ ржкрзБржирж░рзБржжрзНржзрж╛рж░)
        // рж╕ржорж╕рзНржд ржХрж░рзНржоржЪрж╛рж░рзАрж░ рждрж╛рж▓рж┐ржХрж╛ ржкрзБржирж░рзБржжрзНржзрж╛рж░ ржХрж░рзЗ
        [HttpGet]
        public async Task<ActionResult<IEnumerable<Emp>>> GetEmps()
        {
            // ржбрзЗржЯрж╛ржмрзЗрж╕ ржерзЗржХрзЗ рж╕ржорж╕рзНржд ржбрзЗржЯрж╛ ржЕрзНржпрж╛рж╕рж┐ржЩрзНржХрзНрж░рзЛржирж╛рж╕рж▓рж┐ ржкрзБржирж░рзБржжрзНржзрж╛рж░
            return await _context.Emp.ToListAsync();
        }

        // 2. GET: /api/Emps/{id} (ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржбрзЗржЯрж╛ ржкрзБржирж░рзБржжрзНржзрж╛рж░)
        // ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ID-ржПрж░ ржХрж░рзНржоржЪрж╛рж░рзА ржкрзБржирж░рзБржжрзНржзрж╛рж░ ржХрж░рзЗ
        [HttpGet("{id}")]
        public async Task<ActionResult<Emp>> GetEmp(int id)
        {
            // ID ржжрж┐рзЯрзЗ ржХрж░рзНржоржЪрж╛рж░рзА ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛
            var emp = await _context.Emp.FindAsync(id);

            if (emp == null)
            {
                // ржХрж░рзНржоржЪрж╛рж░рзА ржирж╛ ржкрж╛ржУржпрж╝рж╛ ржЧрзЗрж▓рзЗ 404 Not Found рж░рж┐ржЯрж╛рж░рзНржи
                return NotFound("ржПржЗ ID-ржПрж░ ржХрзЛржирзЛ ржХрж░рзНржоржЪрж╛рж░рзА ржЦрзБржБржЬрзЗ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐ред");
            }

            // 200 OK рж╕рж╣ ржбрзЗржЯрж╛ рж░рж┐ржЯрж╛рж░рзНржи
            return emp;
        }

        // 3. POST: /api/Emps (ржирждрзБржи ржбрзЗржЯрж╛ рждрзИрж░рж┐)
        // ржирждрзБржи ржХрж░рзНржоржЪрж╛рж░рзА ржбрзЗржЯрж╛ржмрзЗрж╕рзЗ ржпрзЛржЧ ржХрж░рзЗ
        [HttpPost]
        public async Task<ActionResult<Emp>> PostEmp(Emp emp)
        {
            // ржирждрзБржи ржХрж░рзНржоржЪрж╛рж░рзА ржпрзЛржЧ
            _context.Emp.Add(emp);
            await _context.SaveChangesAsync(); // ржкрж░рж┐ржмрж░рзНрждржи рж╕ржВрж░ржХрзНрж╖ржг

            // 201 Created рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ рж╕рж╣ ржирждрзБржи рждрзИрж░рж┐ рж╣ржУрзЯрж╛ рж░рж┐рж╕рзЛрж░рзНрж╕ рж░рж┐ржЯрж╛рж░рзНржи
            return CreatedAtAction(nameof(GetEmp), new { id = emp.Id }, emp);
        }

        // 4. PUT: /api/Emps/{id} (ржмрж┐ржжрзНржпржорж╛ржи ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ)
        // ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ID-ржПрж░ ржХрж░рзНржоржЪрж╛рж░рзАрж░ ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░рзЗ
        [HttpPut("{id}")]
        public async Task<IActionResult> PutEmp(int id, Emp emp)
        {
            if (id != emp.Id)
            {
                return BadRequest("URL ржПржмржВ ржбрзЗржЯрж╛рж░ ID ржорзЗрж▓рзЗ ржирж╛ред");
            }

            // Entity State ржХрзЗ Modified рж╣рж┐рж╕рзЗржмрзЗ ржЪрж┐рж╣рзНржирж┐ржд ржХрж░рж╛
            _context.Entry(emp).State = EntityState.Modified;

            try
            {
                await _context.SaveChangesAsync(); // ржкрж░рж┐ржмрж░рзНрждржи рж╕ржВрж░ржХрзНрж╖ржг
            }
            catch (DbUpdateConcurrencyException)
            {
                if (!_context.Emp.Any(e => e.Id == id))
                {
                    return NotFound("ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржХрж░рзНржоржЪрж╛рж░рзА ржЦрзБржБржЬрзЗ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐ред");
                }
                else
                {
                    throw; // ржбрзЗржЯрж╛ржмрзЗрж╕ рж╕ржВржХрзНрж░рж╛ржирзНржд рждрзНрж░рзБржЯрж┐
                }
            }

            // рж╕ржлрж▓ржнрж╛ржмрзЗ ржЖржкржбрзЗржЯ рж╣рж▓рзЗ 204 No Content рж░рж┐ржЯрж╛рж░рзНржи
            return NoContent();
        }

        // 5. DELETE: /api/Emps/{id} (ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржбрзЗржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рж╛)
        // ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ID-ржПрж░ ржХрж░рзНржоржЪрж╛рж░рзА ржорзБржЫрзЗ ржлрзЗрж▓рзЗ
        [HttpDelete("{id}")]
        public async Task<IActionResult> DeleteEmp(int id)
        {
            var emp = await _context.Emp.FindAsync(id);
            if (emp == null)
            {
                return NotFound("ржорзБржЫрзЗ ржлрзЗрж▓рж╛рж░ ржЬржирзНржп ржХрж░рзНржоржЪрж╛рж░рзА ржЦрзБржБржЬрзЗ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐ред");
            }

            _context.Emp.Remove(emp);
            await _context.SaveChangesAsync(); // ржкрж░рж┐ржмрж░рзНрждржи рж╕ржВрж░ржХрзНрж╖ржг

            // рж╕ржлрж▓ржнрж╛ржмрзЗ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ рж╣рж▓рзЗ 204 No Content рж░рж┐ржЯрж╛рж░рзНржи
            return NoContent();
        }
    }


}




#####################  .http: ##################### 

# @RestAPI_HostAddress = http://localhost:5102

# GET {{RestAPI_HostAddress}}/weatherforecast/
# Accept: application/json

###


# ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ рж╕рзЗржЯржЖржк: ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗрж░ URL ржПржЦрж╛ржирзЗ рж╕рзЗржЯ ржХрж░рзБржи
@host = http://localhost:5102
@empsRoute = {{host}}/api/Employee
@id = 5
@contentType = application/json

### рзз. рж╕ржХрж▓ ржХрж░рзНржоржЪрж╛рж░рзА ржкрзБржирж░рзБржжрзНржзрж╛рж░ ржХрж░рзБржи (GET ALL)
GET {{empsRoute}} 
Accept: {{contentType}}

###
### рзи. ржирждрзБржи ржХрж░рзНржоржЪрж╛рж░рзА рждрзИрж░рж┐ ржХрж░рзБржи (POST)
# Id ржПржЦрж╛ржирзЗ ржжрзЗржУржпрж╝рж╛ рж╣ржпрж╝ржирж┐, ржХрж╛рж░ржг ржПржЯрж┐ ржбрзЗржЯрж╛ржмрзЗрж╕ ржжрзНржмрж╛рж░рж╛ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣ржмрзЗред
POST {{empsRoute}}
Content-Type: {{contentType}}

{
    "name": "ржЖржмрзНржжрзБрж▓ ржХрж░рж┐ржо",
    "designation": "рж╕рж┐ржирж┐рзЯрж░ ржбрзЗржнрзЗрж▓ржкрж╛рж░",
    "email": "abdul.karim@example.com",
    "userId": 101
}

###
### рзй. ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рзНржоржЪрж╛рж░рзА ржкрзБржирж░рзБржжрзНржзрж╛рж░ ржХрж░рзБржи (GET BY ID)
# ржЙржжрзНржжрзЗрж╢рзНржп: @id ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓рзЗ рж╕рзЗржЯ ржХрж░рж╛ ID-ржПрж░ ржХрж░рзНржоржЪрж╛рж░рзАржХрзЗ ржЦрзБржБржЬрзЗ ржжрзЗржЦрж╛ред
GET {{empsRoute}}/{{id}}
Accept: {{contentType}}

###
### рзк. ржХрж░рзНржоржЪрж╛рж░рзА ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░рзБржи (PUT)
# ржЙржжрзНржжрзЗрж╢рзНржп: @id ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓рзЗ рж╕рзЗржЯ ржХрж░рж╛ ржХрж░рзНржоржЪрж╛рж░рзАрж░ ржбрзЗржЯрж╛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛ред
# PUT ржЕржирзБрж░рзЛржзрзЗ Id ржЕржмрж╢рзНржпржЗ JSON ржмржбрж┐рждрзЗржУ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рждрзЗ рж╣ржмрзЗред
PUT {{empsRoute}}/{{id}}
Content-Type: {{contentType}}

{
    "id": {{id}},
    "name": "ржЖржмрзНржжрзБрж▓ ржХрж░рж┐ржо ржЖрж╣ржорзЗржж",
    "designation": "ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ рж▓рж┐ржб", 
    "email": "abdul.ahmed@example.com", 
    "userId": 101 
}

###
### рзл. ржХрж░рзНржоржЪрж╛рж░рзА ржорзБржЫрзЗ ржлрзЗрж▓рзБржи (DELETE)
# ржЙржжрзНржжрзЗрж╢рзНржп: @id ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓рзЗ рж╕рзЗржЯ ржХрж░рж╛ ржХрж░рзНржоржЪрж╛рж░рзАрж░ ржбрзЗржЯрж╛ ржбрзЗржЯрж╛ржмрзЗрж╕ ржерзЗржХрзЗ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ред
DELETE {{empsRoute}}/{{id}}
Accept: */*









.
